---
title: "Doc-4-Analysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Doc-4-Analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(ftsAnalysis)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/flat_dev_4_analysis.Rmd: do not edit by hand -->


<!-- Run this 'development' chunk -->
<!-- Store every call to library() that you need to explore your functions -->

<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.

If it is the first time you use {fusen}, after 'description', you can directly run the last chunk of the present file with inflate() inside.
--> 

# Global

## analysis_wordcloud_from_flows

  
  
```{r example-analysis_wordcloud_from_flows}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

analysis_wordcloud_from_flows(flows, facet_by_year = FALSE)
# Returns a named list of word cloud objects
yearly_clouds <- analysis_wordcloud_from_flows(flows, facet_by_year = TRUE)

# To view the cloud for a specific year  
print(yearly_clouds[["2015"]])
print(yearly_clouds[["2024"]])
print(yearly_clouds[["2025"]])
```

  
  

## analysis_systemic_network_insights

  
  
```{r example-analysis_systemic_network_insights}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_systemic_network_insights(flows)
print(result$plot)
```

  

## analysis_prepare_opportunity_dataset
  
```{r example-analysis_prepare_opportunity_dataset}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

crisis_keywords = c("refugees", "refugee","displacement", "displaced",
                         "returnees","idps",
                        "protection", "conflict", "vulnerable")

result <- analysis_prepare_opportunity_dataset( flows,
    lookback_years = 3,
    crisis_keywords = crisis_keywords)
print(result$plot)
  
```

  
  
## analysis_fit_opportunity_model
  
```{r example-analysis_fit_opportunity_model}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

features <- analysis_prepare_opportunity_dataset(flows)$data
model_results <- analysis_fit_opportunity_model(features , min_year = NULL)
print(model_results$plot)

```

  
  
  



# Donor or Recipient

## analysis_funding_forecast

Aggregate historical amounts by month and forecast future funding for a donor or recipient.
  
```{r example-analysis_funding_forecast}
#| fig.retina: 2.0
#| fig.width: 12.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_funding_forecast(flows,
                                     by = "donor", 
                                    name = "Germany")
print(result$plot)
```

  
  


# Recipient 

## analysis_portfolio_scores
    
  
```{r example-analysis_portfolio_scores}
#| fig.retina: 2.0
#| fig.width: 12.0
#| fig.asp: 0.418
#| fig.align: center
#| out.width: 90%

result <- analysis_portfolio_scores(flows, 
               recipient_name="United Nations High Commissioner for Refugees", 
                          top_n = 10)

print(result$plot)

```

  
  
## analysis_donor_lifecycle_stage

  
  
```{r example-analysis_donor_lifecycle_stage}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_donor_lifecycle_stage(flows, 
             recipient_name= "United Nations High Commissioner for Refugees" )
print(result$plot)
```

  
  
## analysis_donor_segmentation

  
  
```{r example-analysis_donor_segmentation}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_donor_segmentation(flows,
             recipient_name ="United Nations High Commissioner for Refugees" )
print(result$plot)
```

  
  
## analysis_donor_network_metrics
  
```{r example-analysis_donor_network_metrics}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_donor_network_metrics(flows,
               recipient_name = "United Nations High Commissioner for Refugees")
print(result$plot)
```

  
    
## analysis_competitive_intel_matrix

  
  
```{r example-analysis_competitive_intel_matrix}
#| fig.retina: 2.0
#| fig.width: 8.0
#| fig.asp: 0.618
#| fig.align: center
#| out.width: 90%

result <- analysis_competitive_intel_matrix(flows,
               recipient_name = "United Nations High Commissioner for Refugees",
                peers = NULL)
print(result$plot)
```

  


<!--
# There can be development actions

Create a chunk with 'development' actions

- The chunk needs to be named `development` or `dev`
- It contains functions that are used for package development only
- Note that you may want to store most of these functions in the 0-dev_history.Rmd file

These are only included in the present flat template file, their content will not be part of the package anywhere else.
-->

