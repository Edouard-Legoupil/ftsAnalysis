<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fetch FTS Flow Data with Pagination — fetch_fts_data • ftsAnalysis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fetch FTS Flow Data with Pagination — fetch_fts_data"><meta name="description" content="Retrieves FTS flow data for a specified year, handling API pagination
to pull all available results, not just the first page."><meta property="og:description" content="Retrieves FTS flow data for a specified year, handling API pagination
to pull all available results, not just the first page."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ftsAnalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/1-data-tidying.html">1-Data Tidying</a></li>
    <li><a class="dropdown-item" href="../articles/2-indicators.html">2-Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/4-analysis.html">4-Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/5-visualisation.html">5-Visualisation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edouard-legoupil/ftsAnalysis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fetch FTS Flow Data with Pagination</h1>
      <small class="dont-index">Source: <a href="https://github.com/edouard-legoupil/ftsAnalysis/blob/HEAD/R/fetch_fts_data.R" class="external-link"><code>R/fetch_fts_data.R</code></a></small>
      <div class="d-none name"><code>fetch_fts_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Retrieves FTS flow data for a specified year, handling API pagination
to pull all available results, not just the first page.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fetch_fts_data</span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2023</span>, limit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with funding flow records containing the following variables:</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>FTS (Financial Tracking Service) database</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>Integer. Year to fetch data for (default: 2023).</p></dd>


<dt id="arg-limit">limit<a class="anchor" aria-label="anchor" href="#arg-limit"></a></dt>
<dd><p>Integer. Maximum number of flows per page (API max: 1000).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame of all FTS flows for the specified criteria.#' A dataset containing funding flow information from the FTS database.</p>
    </div>
    <div class="section level2">
    <h2 id="identifiers">Identifiers<a class="anchor" aria-label="anchor" href="#identifiers"></a></h2>


<dl><dt>id</dt>
<dd><p>character Unique identifier for this row, to be used when there are updates to the same funding record</p></dd>

<dt>versionId</dt>
<dd><p>character Version identifier</p></dd>

<dt>childFlowIds</dt>
<dd><p>character The FTS database allows funding flows to be linked together to represent funding cascading through the implementation chain from primary donors to field implementers. When flows are chained together in this way, any flow downstream of the flow being viewed is referred to as a child flow. All child flows have a parent flow upstream.</p></dd>

<dt>parentFlowId</dt>
<dd><p>character The FTS database allows funding flows to be linked together to represent funding cascading through the implementation chain from primary donors to field implementers. When flows are chained together in this way, any flow upstream of the flow being viewed is referred to as the parent flow. All parent flows have one or more child flows downstream.</p></dd>

<dt>flowType</dt>
<dd><p>factor Type of flow with levels: "Carryover", "Parked", "Pass through", "Standard"</p></dd>

<dt>refCode</dt>
<dd><p>character A code related to the grant agreement of the fund, ideally known by the donor and recipient organizations</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="report-details">Report Details<a class="anchor" aria-label="anchor" href="#report-details"></a></h2>


<dl><dt>reportDetails</dt>
<dd><p>list containing:</p><ul><li><p><code>sourceType</code></p></li>
<li><p><code>organization</code></p></li>
<li><p><code>reportChannel</code></p></li>
<li><p><code>date</code></p></li>
</ul></dd>


</dl></div>
    <div class="section level2">
    <h2 id="flow-description">Flow Description<a class="anchor" aria-label="anchor" href="#flow-description"></a></h2>


<dl><dt>description</dt>
<dd><p>character Brief description of the destination activity/project, location within the country, and duration</p></dd>

<dt>grandBargainEarmarkingType</dt>
<dd><p>character Modality of earmarking (Earmarked, Softly earmarked, Tightly earmarked, Unearmarked)</p></dd>

<dt>contributionType</dt>
<dd><p>character Type of contribution: "financial" or "in-kind"</p></dd>

<dt>reportingStatus</dt>
<dd><p>character Status of the humanitarian fund reported per row: "New Contribution", "Top-up/Update", "Old Contribution"</p></dd>

<dt>newMoney</dt>
<dd><p>logical TRUE/FALSE indicating if this is new money</p></dd>

<dt>keywords</dt>
<dd><p>character Keywords associated with the flow</p></dd>

<dt>method</dt>
<dd><p>character Assistance modality: "Cash Transfer Programming (CTP)" or "Traditional"</p></dd>

<dt>boundary</dt>
<dd><p>character Boundary classification: "incoming", "internal", "outgoing"</p></dd>

<dt>onBoundary</dt>
<dd><p>logical Indicator if the flow is on the boundary</p></dd>

<dt>status</dt>
<dd><p>character Status of humanitarian funding: "pledge", "commitment", "paid"</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="quantity">Quantity<a class="anchor" aria-label="anchor" href="#quantity"></a></h2>


<dl><dt>amountUSD</dt>
<dd><p>numeric Total Amount in US$</p></dd>

<dt>fullParkedAmountUSD</dt>
<dd><p>numeric Full parked amount in US$</p></dd>

<dt>originalAmount</dt>
<dd><p>numeric Original amount in the original currency</p></dd>

<dt>originalCurrency</dt>
<dd><p>character Original currency of the humanitarian fund reported</p></dd>

<dt>exchangeRate</dt>
<dd><p>numeric Exchange rate used for conversion. If blank, FTS uses the UN Operational Exchange Rate as of the grant decision date</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="date">Date<a class="anchor" aria-label="anchor" href="#date"></a></h2>


<dl><dt>budgetYear</dt>
<dd><p>integer Year in which the funding will be used. FTS works in calendar year system (January to December)</p></dd>

<dt>date</dt>
<dd><p>Date Date when submitted to FTS</p></dd>

<dt>decisionDate</dt>
<dd><p>Date Date of the grant agreement signing or official endorsement by the donor member state</p></dd>

<dt>firstReportedDate</dt>
<dd><p>Date First reported date</p></dd>

<dt>createdAt</dt>
<dd><p>Date Record creation date</p></dd>

<dt>updatedAt</dt>
<dd><p>Date Record last update date</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="source-1">Source<a class="anchor" aria-label="anchor" href="#source-1"></a></h2>


<dl><dt>sourceObjects</dt>
<dd><p>list containing source information with:</p><ul><li><p><code>id</code> - Source identifier</p></li>
<li><p><code>name</code> - Source name</p></li>
<li><p><code>type</code> - Source type: "Organization" (Source Organisation), "Location" (Location of source organisation), "UsageYear"</p></li>
</ul></dd>


</dl></div>
    <div class="section level2">
    <h2 id="destination">Destination<a class="anchor" aria-label="anchor" href="#destination"></a></h2>


<dl><dt>destinationObjects</dt>
<dd><p>list containing destination information with:</p><ul><li><p><code>id</code> - Destination identifier</p></li>
<li><p><code>name</code> - Destination name</p></li>
<li><p><code>type</code> - Destination type: "Cluster" (technical area in specific coordinated plan), "GlobalCluster" (global technical area), "Location" (where emergency is addressed), "Plan" (Destination Plan/Appeal), "UsageYear", "Organization" (Recipient Organisation)</p></li>
<li><p><code>behavior</code> - Behavior when multiple records of same type: "single" or "shared"</p></li>
<li><p>For type "Organization", additional variables:</p><ul><li><p><code>organizationTypes</code></p></li>
<li><p><code>organizationSubTypes</code></p></li>
<li><p><code>organizationLevels</code></p></li>
</ul></li>
</ul></dd>


</dl></div>
    <div class="section level2">
    <h2 id="flow-type-details">Flow Type Details<a class="anchor" aria-label="anchor" href="#flow-type-details"></a></h2>


<dl><dt>Carryover</dt>
<dd></dd>

<dt>Parked</dt>
<dd><p>A 'parked' flow refers to a funding flow that initially may not be allocated to specific organizations or sectors, but for which additional information is forthcoming. 'Parked' funding is usually a parent flow with a number of linked child flows. Parking a parent flow allows the children to reflect the source information from the linked parent. Parked records are either major funding decisions (e.g. ECHO decisions that begin as a large funding envelope without destination organizations) where the information on recipients is determined at a later time (and added as child flows), or multi-year funding records where yearly contributions are broken down as child flows of the 'parked' flow.</p></dd>

<dt>Pass through</dt>
<dd><p>Pass-through funding refers to downstream funding allocations (e.g. Donor to UN Agency to NGO, Donor to International NGO to Local NGO, etc.)</p></dd>

<dt>Standard</dt>
<dd></dd>


</dl></div>
    <div class="section level2">
    <h2 id="grand-bargain-earmarking-types">Grand Bargain Earmarking Types<a class="anchor" aria-label="anchor" href="#grand-bargain-earmarking-types"></a></h2>


<dl><dt>Unearmarked</dt>
<dd>
<ul><li><p>A: Fully flexible core contribution - Financial contribution to the aid organisation budget, fully flexible (within the boundaries set in mandates, governing body regulations etc.)</p></li>
<li><p>B: Fully flexible core contribution to the CERF - Financial contribution to CERF budget, fully flexible within the CERF regulations.</p></li>
<li><p>C: Core contribution - Financial contribution to a significant part of the aid organisation's mandate, e.g. restricted to the humanitarian operations of a double-mandated organisation. The aid organisation can be instructed to distribute at its discretion - on several strategic objectives/regions/crises to avoid the entire contribution being used in one context.</p></li>
</ul></dd>

<dt>Softly earmarked</dt>
<dd>
<ul><li><p>D: Core contribution with limitations - Financial contribution, but with exclusions pertaining to a small number of specific countries. The aid organisation can be instructed to only use funding outside of certain areas or countries.</p></li>
<li><p>E: Directed to a geographical region or a strategic objective - Financial contribution, fully flexible within the boundaries of the strategic objective (e.g. health or education) or region (e.g. Africa). Should reflect priorities in the Strategic Plan approved by the relevant governing body.</p></li>
<li><p>F: Directed to a Country-Based Pooled Fund - Financial contribution directed to a specific Country-Based Pooled Fund, otherwise fully flexible.</p></li>
</ul></dd>

<dt>Earmarked</dt>
<dd>
<ul><li><p>G: Directed to an aid organisation's country operations - Financial contribution, directed to a specific country, otherwise fully flexible. Should reflect priorities set by the relevant governing body regarding country operations.</p></li>
<li><p>H: Directed to subobjective/target - Financial contribution, directed to subcategories of strategic objectives, e.g. health/malaria or education /teacher training, but without geographical limitations. Should reflect priorities in the Strategic Plan approved by the relevant governing body.</p></li>
</ul></dd>

<dt>Tightly earmarked</dt>
<dd>
<ul><li><p>I: Directed to a specific project - Financial contribution directed to a specific project in a specific country.</p></li>
<li><p>J: Directed geographically and thematically, tied financial - Financial contribution, tied to certain conditions in terms of purchase restrictions, directed to a specific country/region and to a specific objective. For instance, financial contribution for purchase of ABC for school feeding in X-land.</p></li>
<li><p>K: Directed geographically and thematically, in kind - In-kind contribution directed to a specific country/region and to a specific objective. For instance, rice for school feeding in X-land.</p></li>
<li><p>L: Donor-initiated projects/directed contributions - Financial contribution coupled with the demand for a specific project in a specific country fulfilling donor priorities. Not reflecting Strategic Plan of the aid organisation. For instance, it becomes a service provider. This will also put strain on non-project support costs (overhead costs).</p></li>
</ul></dd>


</dl></div>
    <div class="section level2">
    <h2 id="reporting-status">Reporting Status<a class="anchor" aria-label="anchor" href="#reporting-status"></a></h2>


<dl><dt>New Contribution</dt>
<dd><p>The fund is being reported to FTS by the same reporter for the first time</p></dd>

<dt>Top-up/Update</dt>
<dd><p>The fund was reported to FTS by the same reporter and now there is an update on the amount and/or on any other details</p></dd>

<dt>Old Contribution</dt>
<dd><p>The fund was reported to FTS by the same reporter and there is no change. Used when reporters share cumulative reports</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a></h2>


<dl><dt>Cash Transfer Programming (CTP)</dt>
<dd><p>Refers to all programs where cash (or vouchers for goods or services) is directly provided to beneficiaries. The CTP can be of three types: cash, mobile phone transfer and vouchers.</p></dd>

<dt>Traditional</dt>
<dd><p>Non-cash assistance provided in the form of materials or services (i.e. food, tents, PSS, secondment of staff). FTS refers to all other humanitarian assistance modalities as traditional aid.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="boundary">Boundary<a class="anchor" aria-label="anchor" href="#boundary"></a></h2>


<p>Boundaries classify relevant flows into the categories incoming, internal and outgoing. The FTS database records flows of funding, and draws boundaries around (combinations of) flow properties to calculate totals. Examples of common boundaries are a response plan/appeal or a combination of a (donor or affected) country and a year. Drawing a boundary classifies the flows in the database into those crossing the boundary inward (incoming flows), those originating and terminating within the boundary (internal flows), those crossing it outwards (outgoing flows), and a fourth category that is not displayed - those that are irrelevant to the boundary because they originate and terminate outside of it.</p><dl><dt>incoming</dt>
<dd><p>Flows which cross a given search boundary inwards. If the boundary is e.g. an affected country and year, flows originating in donor countries or multilateral organisations attributed to the country are incoming flows, as is carry-over from a previous year. To avoid double-counting, incoming flows should never be added to internal flows.</p></dd>

<dt>internal</dt>
<dd><p>Flows originating and terminating within the boundary</p></dd>

<dt>outgoing</dt>
<dd><p>Flows which originate within and terminate outside a given search boundary. If the boundary is e.g. an affected country and year, flows representing carry-overs to the next year are outgoing flows.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="status">Status<a class="anchor" aria-label="anchor" href="#status"></a></h2>


<dl><dt>pledge</dt>
<dd><p>A non-binding announcement of an intended contribution or allocation by the donor. The recipient organization and response plan or project are not necessarily specified. As soon as a commitment is reported to FTS against a pledge, the amount in the pledge column is reduced accordingly. FTS tables therefore show the 'outstanding' (not 'total original') pledge amount. The information is reported to us directly by donors and agencies and may or may not include verbal commitments made at pledging conferences.</p></dd>

<dt>commitment</dt>
<dd><p>A binding agreement signed between parties OR approval of a grant by the donor member state. Creation of a contractual obligation regarding funding between the donor and appealing agency; almost always takes the form of a signed contract. This is the crucial stage of humanitarian funding: agencies cannot spend money and implement before a funding commitment is made.</p></dd>

<dt>paid</dt>
<dd><p>The money transfer has been realized. FTS does not track disbursements/installments.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># flows &lt;- fetch_fts_data(year = 2025)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># names(flows)</span></span></span>
<span class="r-in"><span><span class="co"># dplyr::glimpse(flows)</span></span></span>
<span class="r-in"><span><span class="co"># nrow(flows)</span></span></span>
<span class="r-in"><span><span class="co"># head(flows,1)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># #sinew::makeOxygen(flows, add_fields = "source")</span></span></span>
<span class="r-in"><span><span class="co"># ## Saving it in the package to avoid constnat API Call</span></span></span>
<span class="r-in"><span><span class="co"># save(flows, file =  here::here("data","flows.RData"))</span></span></span>
<span class="r-in"><span><span class="co"># # Note: significantly better compression could be obtained</span></span></span>
<span class="r-in"><span><span class="co"># #by using R CMD build --resave-data</span></span></span>
<span class="r-in"><span><span class="co"># tools::resaveRdaFiles(here::here("data","flows.RData"),compress="bzip2")</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edouard Legoupil.</p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="https://www.unhcr.org/" target="_blank" rel="noopener noreferrer" class="external-link"><img src="https://raw.githubusercontent.com/unhcr-dataviz/unhcrtemplate/master/man/figures/logo.svg" alt="UNHCR logo" style="max-height:2.5rem"></a></p>
</div>

    </footer></div>





  </body></html>

