% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis_portfolio_scores.R
\name{analysis_portfolio_scores}
\alias{analysis_portfolio_scores}
\title{Compute Portfolio Scores for a Recipient}
\usage{
analysis_portfolio_scores(flows, recipient_name, top_n = 10)
}
\arguments{
\item{flows}{Dataframe \code{flows} as documented (must include sourceObjects,
destinationObjects, amountUSD, budgetYear).}

\item{recipient_name}{Character scalar - recipient destination name to score
donors for (match exactly).}

\item{top_n}{Optional integer - return only top N donors by portfolio score
(default NULL = all).}
}
\value{
a list with data, aka Tibble with columns: donor, donor_engagement,
funding_amount, donor_concentration_risk, strategic_alignment, Portfolio_Score
and plot
}
\description{
Computes a portfolio score for each donor relative to a given recipient
using the formula:
}
\details{
Portfolio_Score = SUM( Donor_engagement *
Funding_amount *
(1 - Donor_concentration_risk) *
Strategic_alignment )

Where:
\itemize{
\item Donor_engagement = fraction of years the donor funded the recipient (0-1)
\item Funding_amount = sum(amountUSD) from donor -> recipient
\item Donor_concentration_risk = HHI of donor across destinations (0-1)
higher = more concentrated implies more risk
\item Strategic_alignment = share of donor funding to the recipient's primary
GlobalCluster (0-1) - best-effort derived
}

Assumptions & notes:
\itemize{
\item \code{recipient_name} is matched against \code{destinationObjects.name}
(destination type "Location" or "Organization" or "Plan").
\item strategic alignment is computed by comparing GlobalCluster names present in
destinationObjects for the recipient vs donor.
\item HHI is calculated per donor across all destination names (locations/plans).
}
}
\examples{
result <- analysis_portfolio_scores(flows, 
               recipient_name="United Nations High Commissioner for Refugees", 
                          top_n = 10)

print(result$plot)

}
